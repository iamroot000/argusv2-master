--- /puppet/dev-mmvpn/templates/iptables.sh	2020-04-13 17:18:27.891574876 +0800
+++ /tmp/iptables.sh	2020-06-08 14:54:17.678245794 +0800
@@ -14,7 +14,13 @@
 /sbin/iptables -A INPUT -m tcp -p tcp --dport 3649 -j ACCEPT  #other
 #outsidevpn
 /sbin/iptables -A INPUT -m udp -p udp --dport 57240:57299 -j ACCEPT  #other  ss in  setver
-/sbin/iptables -A INPUT -m udp -p udp --dport 41410:65534 -j ACCEPT #
-/sbin/iptables -A INPUT -m tcp -p tcp --dport 41410:65534 -j ACCEPT #
+/sbin/iptables -A INPUT -m udp -p udp --dport 41410:41418 -j ACCEPT #
+/sbin/iptables -A INPUT -m udp -p udp --dport 41410:41418 -j ACCEPT #
+/sbin/iptables -A INPUT -m tcp -p tcp --dport 41420:65534 -j ACCEPT #
+/sbin/iptables -A INPUT -m tcp -p tcp --dport 41420:65534 -j ACCEPT #
+/sbin/iptables -A INPUT -m udp -p udp --dport 41419 -s 39.108.231.108 -j ACCEPT   # ss-manager <- VPN19 UserAPI
+/sbin/iptables -A INPUT -m udp -p udp --dport 41419 -s 47.252.74.45   -j ACCEPT   # ss-manager <- Asiaroutes UserAPI
+/sbin/iptables -A INPUT -m udp -p udp --dport 41419 -s 47.252.77.28   -j ACCEPT   # ss-manager <- Asiaroutes Lite UserAPI
+/sbin/iptables -A INPUT -m udp -p udp --dport 41419 -s 39.108.231.108 -j ACCEPT   # ss-manager <- Staging UserAPI (useful for testing)
 /sbin/iptables -A INPUT -m udp -p udp --dport 53 -j ACCEPT #
 /sbin/iptables -A INPUT -m tcp -p tcp --dport 53 -j ACCEPT #


PUPPET_COMMAND_START
[WARNING]: Invalid characters were found in group names but not replaced, use
-vvvv to see details

PLAY [puppmaster-b2c] **********************************************************


TASK [puppetmaster : get hostname] *********************************************
changed: [puppmaster-b2c]

TASK [puppetmaster : Read hostvars] ********************************************
changed: [puppmaster-b2c]


TASK [puppetmaster : Create Json Template] *************************************
skipping: [puppmaster-b2c]

TASK [puppetmaster : Append Json Data] *****************************************

skipping: [puppmaster-b2c]

TASK [puppetmaster : remove ansible block] *************************************
skipping: [puppmaster-b2c]


TASK [puppetmaster : get value for iptables] ***********************************
changed: [puppmaster-b2c]

TASK [puppetmaster : check data] ***********************************************
ok: [puppmaster-b2c]


TASK [puppetmaster : get value for ssh_keys] ***********************************
changed: [puppmaster-b2c]

TASK [puppetmaster : check data] ***********************************************

ok: [puppmaster-b2c]

TASK [puppetmaster : get value for filebeat] ***********************************
changed: [puppmaster-b2c]


TASK [puppetmaster : check data] ***********************************************
ok: [puppmaster-b2c]

TASK [puppetmaster : stat] *****************************************************
ok: [puppmaster-b2c]


TASK [puppetmaster : debug] ****************************************************
skipping: [puppmaster-b2c]

TASK [puppetmaster : stat] *****************************************************

skipping: [puppmaster-b2c]

TASK [puppetmaster : debug] ****************************************************
skipping: [puppmaster-b2c]


TASK [puppetmaster : stat] *****************************************************
skipping: [puppmaster-b2c]

TASK [puppetmaster : debug] ****************************************************
skipping: [puppmaster-b2c]


TASK [puppetmaster : stat] *****************************************************
ok: [puppmaster-b2c]

TASK [puppetmaster : debug] ****************************************************

skipping: [puppmaster-b2c]

TASK [puppetmaster : set_fact] *************************************************
ok: [puppmaster-b2c]


TASK [puppetmaster : include_tasks] ********************************************
included: /docker/ansible/puppet/roles/puppetmaster/tasks/puppetcreate.yml for puppmaster-b2c

TASK [puppetmaster : Create sub directory] *************************************
ok: [puppmaster-b2c] => (item=modules)

ok: [puppmaster-b2c] => (item=manifests)

TASK [puppetmaster : Create IPTABLES Modules Manifests subdirectory] ***********
ok: [puppmaster-b2c] => (item=manifests)
ok: [puppmaster-b2c] => (item=templates)


TASK [puppetmaster : Create SSH_KEYS Modules Manifests subdirectory] ***********
skipping: [puppmaster-b2c] => (item=manifests) 
skipping: [puppmaster-b2c] => (item=templates) 


TASK [puppetmaster : Create STDLIB Modules Manifests subdirectory] *************
ok: [puppmaster-b2c]

TASK [puppetmaster : Create Filebeat Modules Manifests subdirectory] ***********
ok: [puppmaster-b2c] => (item=manifests)

ok: [puppmaster-b2c] => (item=templates)

TASK [puppetmaster : Provide puppet environment] *******************************
ok: [puppmaster-b2c]


TASK [puppetmaster : Check defaults manifests node] ****************************
ok: [puppmaster-b2c]

TASK [puppetmaster : Create defaults manifests] ********************************
skipping: [puppmaster-b2c]


TASK [puppetmaster : iptables modules] *****************************************
included: /docker/ansible/puppet/roles/puppetmaster/tasks/iptables.yml for puppmaster-b2c

TASK [puppetmaster : Get iptables config df] ***********************************

skipping: [puppmaster-b2c]

TASK [puppetmaster : Get iptables config df] ***********************************
skipping: [puppmaster-b2c]


TASK [puppetmaster : Get iptables config k365] *********************************
skipping: [puppmaster-b2c]

TASK [puppetmaster : Get iptables config ebet] *********************************
skipping: [puppmaster-b2c]


TASK [puppetmaster : Get iptables config omcdnnginx] ***************************
skipping: [puppmaster-b2c]

TASK [puppetmaster : Get iptables config 51sipfs] ******************************

skipping: [puppmaster-b2c]

TASK [puppetmaster : Get iptables config qp] ***********************************
skipping: [puppmaster-b2c]


TASK [puppetmaster : Get iptables config v68-test] *****************************
skipping: [puppmaster-b2c]

TASK [puppetmaster : Get iptables config] **************************************
ok: [puppmaster-b2c]


TASK [puppetmaster : Get iptables config cdn] **********************************
skipping: [puppmaster-b2c]

TASK [puppetmaster : Get iptables config cdn] **********************************

skipping: [puppmaster-b2c]

TASK [puppetmaster : Get additional iptables config] ***************************
changed: [puppmaster-b2c]


TASK [puppetmaster : Get iptables puppet] **************************************
ok: [puppmaster-b2c]

TASK [puppetmaster : Get iptables config] **************************************
skipping: [puppmaster-b2c]


TASK [puppetmaster : find iptables.sh] *****************************************
skipping: [puppmaster-b2c]

TASK [puppetmaster : set fact] *************************************************

skipping: [puppmaster-b2c]

TASK [puppetmaster : Get additional iptables config] ***************************
skipping: [puppmaster-b2c]


TASK [puppetmaster : Create append iptables] ***********************************
skipping: [puppmaster-b2c]

TASK [puppetmaster : Append iptables] ******************************************
skipping: [puppmaster-b2c]


TASK [puppetmaster : Get additional iptables config] ***************************
skipping: [puppmaster-b2c]

TASK [puppetmaster : Get iptables puppet] **************************************

skipping: [puppmaster-b2c]

TASK [puppetmaster : ssh_keys modules] *****************************************
skipping: [puppmaster-b2c]


TASK [puppetmaster : filebeat modules] *****************************************
included: /docker/ansible/puppet/roles/puppetmaster/tasks/filebeat.yml for puppmaster-b2c

TASK [puppetmaster : Get filebeat config] **************************************
ok: [puppmaster-b2c]


TASK [puppetmaster : Get filebeat puppet] **************************************
ok: [puppmaster-b2c]

TASK [puppetmaster : Get rsyslog] **********************************************

ok: [puppmaster-b2c]

PLAY [euqp-online_db] **********************************************************

TASK [add-repo : set_fact] *****************************************************

skipping: [47.52.207.208]
skipping: [47.56.109.163]

TASK [add-repo : Read hostvars] ************************************************
changed: [47.52.207.208]


TASK [add-repo : Create Json Template] *****************************************
skipping: [47.52.207.208]

TASK [add-repo : Append Json Data] *********************************************

skipping: [47.52.207.208]

TASK [add-repo : remove ansible block] *****************************************
skipping: [47.52.207.208]


TASK [add-repo : get value for iptables] ***************************************
changed: [47.52.207.208]

TASK [add-repo : check data] ***************************************************
ok: [47.52.207.208]


TASK [add-repo : get value for ssh_keys] ***************************************
changed: [47.52.207.208]

TASK [add-repo : check data] ***************************************************

ok: [47.52.207.208]

TASK [add-repo : get value for filebeat] ***************************************
changed: [47.52.207.208]


TASK [add-repo : check data] ***************************************************
ok: [47.52.207.208]

TASK [add-repo : Copy Centos Base Repo] ****************************************
skipping: [47.52.207.208]

skipping: [47.56.109.163]

TASK [add-repo : install the latest version of yum-utils] **********************
ok: [47.56.109.163]
ok: [47.52.207.208]


TASK [add-repo : check if puppet is installed] *********************************
[WARNING]: Consider using the yum module rather than running 'yum'.  If you
need to use command because yum is insufficient you can add 'warn: false' to
this command task or set 'command_warnings=False' in ansible.cfg to get rid of

this message.
changed: [47.56.109.163]
changed: [47.52.207.208]

TASK [add-repo : include_tasks] ************************************************

skipping: [47.52.207.208]
skipping: [47.56.109.163]

TASK [add-repo : include_tasks] ************************************************
skipping: [47.52.207.208]

skipping: [47.56.109.163]

TASK [add-repo : include_tasks] ************************************************
skipping: [47.52.207.208]
skipping: [47.56.109.163]


TASK [puppet : set_fact] *******************************************************
skipping: [47.52.207.208]
skipping: [47.56.109.163]


TASK [puppet : Read hostvars] **************************************************
changed: [47.52.207.208]

TASK [puppet : Create Json Template] *******************************************
skipping: [47.52.207.208]


TASK [puppet : Append Json Data] ***********************************************
skipping: [47.52.207.208]

TASK [puppet : remove ansible block] *******************************************

skipping: [47.52.207.208]

TASK [puppet : get value for iptables] *****************************************
changed: [47.52.207.208]


TASK [puppet : check data] *****************************************************
ok: [47.52.207.208]

TASK [puppet : get value for ssh_keys] *****************************************
changed: [47.52.207.208]


TASK [puppet : check data] *****************************************************
ok: [47.52.207.208]

TASK [puppet : get value for filebeat] *****************************************

changed: [47.52.207.208]

TASK [puppet : check data] *****************************************************
ok: [47.52.207.208]


TASK [puppet : set_fact] *******************************************************
ok: [47.52.207.208]
ok: [47.56.109.163]

TASK [puppet : install curl] ***************************************************

skipping: [47.52.207.208]
skipping: [47.56.109.163]

TASK [puppet : Get IP b2b dc] **************************************************
skipping: [47.52.207.208]

skipping: [47.56.109.163]

TASK [puppet : Get ipset] ******************************************************
skipping: [47.52.207.208]
skipping: [47.56.109.163]


TASK [puppet : Get IP b2b dc] **************************************************
skipping: [47.52.207.208]
skipping: [47.56.109.163]


TASK [puppet : Get ipset] ******************************************************
skipping: [47.52.207.208]
skipping: [47.56.109.163]

TASK [puppet : Get IP] *********************************************************

[WARNING]: Consider using the get_url or uri module rather than running 'curl'.
If you need to use command because get_url or uri is insufficient you can add
'warn: false' to this command task or set 'command_warnings=False' in
ansible.cfg to get rid of this message.
changed: [47.52.207.208]

changed: [47.56.109.163]

TASK [puppet : Get ipset] ******************************************************
ok: [47.52.207.208]
ok: [47.56.109.163]


TASK [puppet : Get ipset] ******************************************************
ok: [47.52.207.208] => {
    "msg": "47.52.207.208"
}

ok: [47.56.109.163] => {
    "msg": "47.56.109.163"
}

TASK [puppet : Get If IP is here] **********************************************

changed: [47.52.207.208 -> 161.202.63.231]
changed: [47.56.109.163 -> 161.202.63.231]

TASK [puppet : check if environment] *******************************************
changed: [47.52.207.208]

changed: [47.56.109.163]

TASK [puppet : pv] *************************************************************
changed: [47.52.207.208]
changed: [47.56.109.163]


TASK [puppet : get data] *******************************************************
skipping: [47.52.207.208]
skipping: [47.56.109.163]


TASK [puppet : get data] *******************************************************
ok: [47.52.207.208]
ok: [47.56.109.163]

TASK [puppet : include_tasks] **************************************************

skipping: [47.52.207.208]
skipping: [47.56.109.163]

TASK [remove puppet.conf for now] **********************************************
changed: [47.52.207.208]

changed: [47.56.109.163]

TASK [puppet : include_tasks] **************************************************
skipping: [47.52.207.208]
skipping: [47.56.109.163]


TASK [puppet : include_tasks] **************************************************
skipping: [47.52.207.208]
skipping: [47.56.109.163]


TASK [puppet : include_tasks] **************************************************
included: /docker/ansible/puppet/roles/puppet/tasks/pupmaster.yml for 47.52.207.208, 47.56.109.163

TASK [puppet : Get if ip exclude] **********************************************
fatal: [47.52.207.208]: FAILED! => {"changed": true, "cmd": "cat /ansible/puppet/ipexclude|grep 47.52.207.208", "delta": "0:00:00.042214", "end": "2020-12-04 09:28:16.128391", "msg": "non-zero return code", "rc": 1, "start": "2020-12-04 09:28:16.086177", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

...ignoring
fatal: [47.56.109.163]: FAILED! => {"changed": true, "cmd": "cat /ansible/puppet/ipexclude|grep 47.56.109.163", "delta": "0:00:00.041637", "end": "2020-12-04 09:28:16.160043", "msg": "non-zero return code", "rc": 1, "start": "2020-12-04 09:28:16.118406", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
...ignoring

TASK [puppet : set ipexclude] **************************************************

skipping: [47.52.207.208]
skipping: [47.56.109.163]

TASK [puppet : ubuntu] *********************************************************
skipping: [47.52.207.208]

skipping: [47.56.109.163]

TASK [puppet : ebet] ***********************************************************
skipping: [47.52.207.208]
skipping: [47.56.109.163]


TASK [puppet : b2b] ************************************************************
skipping: [47.52.207.208]
skipping: [47.56.109.163]


TASK [puppet : Create append euqponlinedb manifests] ***************************
ok: [47.52.207.208]
ok: [47.56.109.163]

TASK [puppet : Create append euqponlinedb manifests] ***************************

skipping: [47.52.207.208]
skipping: [47.56.109.163]

TASK [puppet : Append to euqponlinedb manifests] *******************************
ok: [47.56.109.163 -> None]

ok: [47.52.207.208 -> None]

TASK [puppet : command] ********************************************************
changed: [47.52.207.208 -> None]
changed: [47.56.109.163 -> None]


TASK [puppet : reappend to euqponlinedb manifests] *****************************
skipping: [47.52.207.208]
skipping: [47.56.109.163]


TASK [puppet : reappend to euqponlinedb manifests again] ***********************
skipping: [47.52.207.208]
skipping: [47.56.109.163]

TASK [puppet : Removing iptables on node] **************************************

skipping: [47.52.207.208]
skipping: [47.56.109.163]

TASK [puppet : Removing nginx on node] *****************************************
skipping: [47.52.207.208]

skipping: [47.56.109.163]

TASK [puppet : Truncate Midpay] ************************************************
skipping: [47.52.207.208]
skipping: [47.56.109.163]


TASK [puppet : Removing sshkeys on node] ***************************************
skipping: [47.52.207.208]
skipping: [47.56.109.163]


TASK [puppet : Removing filebeat on node] **************************************
skipping: [47.52.207.208]
skipping: [47.56.109.163]

TASK [puppet : include_tasks] **************************************************

included: /docker/ansible/puppet/roles/puppet/tasks/pupconfig.yml for 47.52.207.208, 47.56.109.163

TASK [puppet : Change server if b2b] *******************************************
skipping: [47.52.207.208]
skipping: [47.56.109.163]


TASK [Add puppet conf] *********************************************************
changed: [47.52.207.208]
changed: [47.56.109.163]


TASK [puppet : include_tasks] **************************************************
skipping: [47.52.207.208]
skipping: [47.56.109.163]

TASK [puppet : include_tasks] **************************************************

included: /docker/ansible/puppet/roles/puppet/tasks/start.yml for 47.52.207.208, 47.56.109.163

TASK [Start service puppet, if not running] ************************************
ok: [47.52.207.208]
ok: [47.56.109.163]


TASK [Enable puppet services] **************************************************
ok: [47.52.207.208]
ok: [47.56.109.163]


PLAY [euqp-online_db] **********************************************************

TASK [Kill Old Puppet Agent] ***************************************************
changed: [47.52.207.208]
changed: [47.56.109.163]


TASK [Generate Puppet Cert] ****************************************************
changed: [47.56.109.163]
changed: [47.52.207.208]


TASK [Start service puppet, if not running] ************************************
changed: [47.52.207.208]
changed: [47.56.109.163]

PLAY [127.0.0.1] ***************************************************************


TASK [sync_to_git : Read hostvars] *********************************************
changed: [127.0.0.1]

TASK [sync_to_git : Create Json Template] **************************************

skipping: [127.0.0.1]

TASK [sync_to_git : Append Json Data] ******************************************
skipping: [127.0.0.1]


TASK [sync_to_git : remove ansible block] **************************************
skipping: [127.0.0.1]

TASK [sync_to_git : get value for iptables] ************************************
changed: [127.0.0.1]


TASK [sync_to_git : check data] ************************************************
ok: [127.0.0.1]

TASK [sync_to_git : get value for ssh_keys] ************************************

changed: [127.0.0.1]

TASK [sync_to_git : check data] ************************************************
ok: [127.0.0.1]


TASK [sync_to_git : get value for filebeat] ************************************
changed: [127.0.0.1]

TASK [sync_to_git : check data] ************************************************
ok: [127.0.0.1]


TASK [sync_to_git : Synchronizing Puppet template To GIT] **********************
fatal: [127.0.0.1]: FAILED! => {"changed": true, "cmd": "git add .\ngit commit -m \"huili.lee\"\ngit push  \ngit push -u origin master\n", "delta": "0:00:00.483769", "end": "2020-12-04 09:28:26.467876", "msg": "non-zero return code", "rc": 1, "start": "2020-12-04 09:28:25.984107", "stderr": "warning: push.default is unset; its implicit value is changing in\nGit 2.0 from 'matching' to 'simple'. To squelch this message\nand maintain the current behavior after the default changes, use:\n\n  git config --global push.default matching\n\nTo squelch this message and adopt the new behavior now, use:\n\n  git config --global push.default simple\n\nSee 'git help config' and search for 'push.default' for further information.\n(the 'simple' mode was introduced in Git 1.7.11. Use the similar mode\n'current' instead of 'simple' if you sometimes use older versions of Git)\n\nTo http://om:sPCJ-015@git.neweb.me/puppet_cloud/om-euqp_database.git\n ! [rejected]        master -> master (fetch first)\nerror: failed to push some refs to 'http://om:sPCJ-015@git.neweb.me/puppet_cloud/om-euqp_database.git'\nhint: Updates were rejected because the remote contains work that you do\nhint: not have locally. This is usually caused by another repository pushing\nhint: to the same ref. You may want to first merge the remote changes (e.g.,\nhint: 'git pull') before pushing again.\nhint: See the 'Note about fast-forwards' in 'git push --help' for details.\nTo http://om:sPCJ-015@git.neweb.me/puppet_cloud/om-euqp_database.git\n ! [rejected]        master -> master (fetch first)\nerror: failed to push some refs to 'http://om:sPCJ-015@git.neweb.me/puppet_cloud/om-euqp_database.git'\nhint: Updates were rejected because the remote contains work that you do\nhint: not have locally. This is usually caused by another repository pushing\nhint: to the same ref. You may want to first merge the remote changes (e.g.,\nhint: 'git pull') before pushing again.\nhint: See the 'Note about fast-forwards' in 'git push --help' for details.", "stderr_lines": ["warning: push.default is unset; its implicit value is changing in", "Git 2.0 from 'matching' to 'simple'. To squelch this message", "and maintain the current behavior after the default changes, use:", "", "  git config --global push.default matching", "", "To squelch this message and adopt the new behavior now, use:", "", "  git config --global push.default simple", "", "See 'git help config' and search for 'push.default' for further information.", "(the 'simple' mode was introduced in Git 1.7.11. Use the similar mode", "'current' instead of 'simple' if you sometimes use older versions of Git)", "", "To http://om:sPCJ-015@git.neweb.me/puppet_cloud/om-euqp_database.git", " ! [rejected]        master -> master (fetch first)", "error: failed to push some refs to 'http://om:sPCJ-015@git.neweb.me/puppet_cloud/om-euqp_database.git'", "hint: Updates were rejected because the remote contains work that you do", "hint: not have locally. This is usually caused by another repository pushing", "hint: to the same ref. You may want to first merge the remote changes (e.g.,", "hint: 'git pull') before pushing again.", "hint: See the 'Note about fast-forwards' in 'git push --help' for details.", "To http://om:sPCJ-015@git.neweb.me/puppet_cloud/om-euqp_database.git", " ! [rejected]        master -> master (fetch first)", "error: failed to push some refs to 'http://om:sPCJ-015@git.neweb.me/puppet_cloud/om-euqp_database.git'", "hint: Updates were rejected because the remote contains work that you do", "hint: not have locally. This is usually caused by another repository pushing", "hint: to the same ref. You may want to first merge the remote changes (e.g.,", "hint: 'git pull') before pushing again.", "hint: See the 'Note about fast-forwards' in 'git push --help' for details."], "stdout": "[master 21fbf98] huili.lee\n 1 file changed, 1 insertion(+)", "stdout_lines": ["[master 21fbf98] huili.lee", " 1 file changed, 1 insertion(+)"]}

PLAY RECAP *********************************************************************

127.0.0.1                  : ok=7    changed=4    unreachable=0    failed=1    skipped=3    rescued=0    ignored=0   
47.52.207.208              : ok=38   changed=20   unreachable=0    failed=0    skipped=35   rescued=0    ignored=1   
47.56.109.163              : ok=24   changed=12   unreachable=0    failed=0    skipped=29   rescued=0    ignored=1   
puppmaster-b2c             : ok=26   changed=6    unreachable=0    failed=0    skipped=30   rescued=0    ignored=0   



PUPPET_COMMAND_END
MAX RETRIES EXECUTED, COMMAND NOT RESPONDING
upstream 8070main {
        #server 127.0.0.1:8072 max_fails=1  fail_timeout=2s; # Globe
        server 127.0.0.1:8071 max_fails=1  fail_timeout=2s; #pacnet *
        server 127.0.0.1:8073 max_fails=1  fail_timeout=2s backup;  #wtt **
        #server 127.0.0.1:8074 max_fails=1  fail_timeout=2s; #pcct
}

upstream ebetmain {
	server 47.90.56.112:8070;
	server 13.75.124.202:8070;
}


server {
    listen   80;
    server_name main.ebetapi888.com opus.ebetapi888.com;
    return   444;
}

server {
        listen     8070;
        server_name mainapi.ebet2017.com;
        index index.jsp index.html index.htm;
        charset utf-8;

        access_log  logs/mainapi.ebet2017.com.access.log main;
        location ~ ^/(WEB-INF)/ {
        deny all;
        }

        location / {
            include proxy.conf.gm;
        proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_pass http://ebetmain;
        }


        error_page   404 404.jsp;
        error_page   500 502 503 500.jsp;
        }





#opusdevweb
server {
        listen     8070;
        server_name main.ebetapi888.com;
        index index.jsp index.html index.htm;
        charset utf-8;
        #ssl on;
        #ssl_certificate /usr/local/nginx/conf/ssl/ebetapi888.com/fullchain.pem;
        #ssl_certificate_key /usr/local/nginx/conf/ssl/ebetapi888.com/privkey.pem;

        access_log  logs/main.ebetapi888.com.access.log main;
        location ~ ^/(WEB-INF)/ {
        deny all;
        }

        location / {
            include proxy.conf.gm;
	    proxy_http_version 1.1;
            proxy_set_header Connection "";

            proxy_pass http://8070main;
            #proxy_pass http://127.0.0.1:8071;
        }


        error_page   404 404.jsp;
        error_page   500 502 503 500.jsp;
        }

upstream 3001opus {
        server 203.177.198.116:3001 max_fails=1  fail_timeout=2s backup;
        server 203.192.151.12:3001 max_fails=1  fail_timeout=2s backup;
        server 101.78.133.212:3001 max_fails=1  fail_timeout=2s backup;
        server 205.177.199.12:3001 max_fails=1  fail_timeout=2s;
}

upstream 3002opus {
        server 203.177.198.116:3003 max_fails=1  fail_timeout=2s backup;
        server 203.192.151.12:3003 max_fails=1  fail_timeout=2s backup;
        server 101.78.133.212:3003 max_fails=1  fail_timeout=2s backup;
        server 205.177.199.12:3003 max_fails=1  fail_timeout=2s;
}


server {
        listen     80;
        server_name pt.ebetapi888.com;
        index index.jsp index.html index.htm;
        charset utf-8;

        access_log  logs/pt.ebetapi888.com.access.log main;
        location ~ ^/(WEB-INF)/ {
        deny all;
        }

        location / {
            include proxy.conf.gm;
            proxy_pass http://3002opus;
        }


        error_page   404 404.jsp;
        error_page   500 502 503 500.jsp;
        }





#opusdevweb
server {
        listen     3001;
        server_name opus.ebetapi888.com;
        index index.jsp index.html index.htm;
        charset utf-8;

        access_log  logs/opus.ebetapi888.com.access.log main;
        location ~ ^/(WEB-INF)/ {
        deny all;
        }

        location / {
            include proxy.conf.gm;
            proxy_pass http://3001opus;
        }


        error_page   404 404.jsp;
        error_page   500 502 503 500.jsp;
        }


upstream 3000office {
        #server 203.177.198.116:3000 max_fails=1  fail_timeout=2s ;
        server 203.192.151.12:3000 max_fails=1  fail_timeout=2s ;
        #server 101.78.133.212:3000 max_fails=1  fail_timeout=2s;
        #server 205.177.199.12:3000 max_fails=1  fail_timeout=2s;
}


#opusdevweb
server {
        #listen     443;
	listen 3000;
        server_name office.ebetapi888.com;
        index index.jsp index.html index.htm;
        charset utf-8;
        #ssl on;
        #ssl_certificate /usr/local/nginx/conf/ssl/ebetapi888.com/fullchain.pem;
        #ssl_certificate_key /usr/local/nginx/conf/ssl/ebetapi888.com/privkey.pem;

        access_log  logs/office.ebetapi888.com.access.log main;
        location ~ ^/(WEB-INF)/ {
        deny all;
        }

        location / {
            include proxy.conf.gm;
	    proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_pass http://3000office;
        }

	location ~* .*\.(png|jpg|gif|jpeg|bmp|ico|css|js|json|exe)?$ {
         proxy_cache_use_stale http_500 http_502 http_504 error timeout updating invalid_header;
            proxy_cache cache_after;
            proxy_cache_valid  200 304 12h;
            proxy_cache_key $uri$is_args$args;
            proxy_set_header Host  $host;
            proxy_set_header X-Forwarded-For  $remote_addr;
		proxy_pass http://3000office;

	
	}


        error_page   404 404.jsp;
        error_page   500 502 503 500.jsp;
        }






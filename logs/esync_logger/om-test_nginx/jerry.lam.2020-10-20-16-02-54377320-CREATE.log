--- /ansible/nginx/hostgroups/om-test_nginx/nginx/conf.d/include/xjw3-byl-test.include	2020-10-20 15:45:37.702459890 +0800
+++ /tmp/xjw3-byl-test.include	2020-10-20 16:02:54.356951570 +0800
@@ -42,17 +42,29 @@
 	}
 
 
-	access_log  logs/bylaccess.log main;
-	access_log  logs/bylerror.log main;
-
 	location / {
-             index  index.html;
-             root  /usr/local/nginx/html/maintenance/;
-            if ( $http_user_agent ~* "(Android|iPhone|Windows Phone|UC|Kindle)") {
-                       root /usr/local/nginx/html/maintenance/;
-             } 
+            proxy_set_header Host  $host;
+            proxy_set_header X-Forwarded-For  $remote_addr;
+            proxy_set_header X-Forwarded-Proto $scheme ;
+	    proxy_pass http://$upstream;
+        }
 
-		}
+       location /websocket {
+            proxy_set_header            X-Forwarded-For $proxy_add_x_forwarded_for;
+            #proxy_set_header X-Forwarded-For  $remote_addr;
+            proxy_set_header        X-Real-IP       $remote_addr;
+            proxy_next_upstream http_502 http_504 http_404 error timeout invalid_header;
+            proxy_set_header Host $host:$server_port;
+            proxy_http_version 1.1;
+            proxy_set_header Upgrade $http_upgrade;
+            proxy_set_header Connection $connection_upgrade;
+            #proxy_pass http://9288;
+  				# if ($http_host = 'xjw2-xpj.neweb.me' ){
+            proxy_pass http://9288;
+ 				# }
+            #proxy_pass http://dev9280;
+            
+        }
 
 	location ~* .*\.(png|jpg|gif|jpeg|bmp|ico|css|js|json|exe)?$ {
             proxy_next_upstream http_502 http_504 error timeout invalid_header;

